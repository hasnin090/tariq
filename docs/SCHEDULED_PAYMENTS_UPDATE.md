# ุชุญุฏูุซ ูุธุงู ุงูุฏูุนุงุช ุงููุฌุฏููุฉ ูุงูุชูุจููุงุช

## ุงูุชุญุฏูุซุงุช ุงููุทุจูุฉ

### 1. ุชุงุฑูุฎ ุงููุณุท ุงูุฃูู (5 ุฃูุงู ุจุนุฏ ุชุงุฑูุฎ ุงูุญุฌุฒ)

ุชู ุชุญุฏูุซ ูุธุงู ุงูุฏูุนุงุช ุงููุฌุฏููุฉ ุจุญูุซ ูุจุฏุฃ ุงููุณุท ุงูุฃูู ุจุนุฏ **5 ุฃูุงู** ูู ุชุงุฑูุฎ ุงูุญุฌุฒ ุชููุงุฆูุงู.

#### ุงูุชุบููุฑุงุช ูู ุงูููุฏ:

**ุงูููู**: `components/pages/sales/Bookings.tsx`

1. **ุฏุงูุฉ ุฌุฏูุฏุฉ ูุญุณุงุจ ุชุงุฑูุฎ ุงููุณุท ุงูุฃูู**:
```typescript
const getDefaultStartDate = (bookingDate: string) => {
    const date = new Date(bookingDate);
    date.setDate(date.getDate() + 5); // ุฅุถุงูุฉ 5 ุฃูุงู
    return date.toISOString().split('T')[0];
};
```

2. **ุชุญุฏูุซ ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ ุนูุฏ ุฅูุดุงุก ุญุฌุฒ ุฌุฏูุฏ**:
```typescript
paymentStartDate: booking?.paymentStartDate || getDefaultStartDate(
    booking?.bookingDate || new Date().toISOString().split('T')[0]
)
```

3. **ุชุญุฏูุซ ุชููุงุฆู ุนูุฏ ุชุบููุฑ ุชุงุฑูุฎ ุงูุญุฌุฒ**:
ุนูุฏ ุชุบููุฑ ุชุงุฑูุฎ ุงูุญุฌุฒ ูู ุงููููุฐุฌุ ูุชู ุชุญุฏูุซ ุชุงุฑูุฎ ุงููุณุท ุงูุฃูู ุชููุงุฆูุงู ููููู ุจุนุฏ 5 ุฃูุงู ูู ุงูุชุงุฑูุฎ ุงูุฌุฏูุฏ.

4. **ููุงุญุธุฉ ุชูุถูุญูุฉ ูู ุงููุงุฌูุฉ**:
```
๐ก ุณูุจุฏุฃ ุงููุณุท ุงูุฃูู ุจุนุฏ 5 ุฃูุงู ูู ุชุงุฑูุฎ ุงูุญุฌุฒ ุชููุงุฆูุงู
```

#### ูุซุงู:
- **ุชุงุฑูุฎ ุงูุญุฌุฒ**: 2025-12-29
- **ุชุงุฑูุฎ ุงููุณุท ุงูุฃูู**: 2026-01-03 (ุชููุงุฆูุงู)

---

### 2. ูุธุงู ุงูุชูุจููุงุช ุนูุฏ ุงูุชุฑุงุจ ููุนุฏ ุชุณุฏูุฏ ุงูุฏูุนุฉ

ูุธุงู ุงูุชูุจููุงุช **ููุฌูุฏ ููุนูู** ุจุดูู ูุงูู ูุน ุงูููุฒุงุช ุงูุชุงููุฉ:

#### ุฃ. ุฃููุงุน ุงูุชูุจููุงุช

1. **ุชูุจูู ุงูุฏูุนุฉ ุงููุงุฏูุฉ** (`payment_due_soon`)
   - ููุฑุณู ุนูุฏ ูุฌูุฏ ุฏูุนุฉ ูุณุชุญูุฉ ุฎูุงู 7 ุฃูุงู
   - ุงูุฃููููุฉ: ูุชูุณุทุฉ ุฃู ุนุงููุฉ ุญุณุจ ุงูุฃูุงู ุงููุชุจููุฉ

2. **ุชูุจูู ุงูุฏูุนุฉ ุงูููู** (`payment_due_today`)
   - ููุฑุณู ุนูุฏูุง ุชููู ุงูุฏูุนุฉ ูุณุชุญูุฉ ุงูููู
   - ุงูุฃููููุฉ: ุนุงุฌูุฉ (urgent)

3. **ุชูุจูู ุงูุฏูุนุฉ ุงููุชุฃุฎุฑุฉ** (`payment_overdue`)
   - ููุฑุณู ุนูุฏ ุชุฌุงูุฒ ููุนุฏ ุงูุฏูุนุฉ
   - ุงูุฃููููุฉ: ุนุงุฌูุฉ (urgent)

#### ุจ. ุฌุฏูู ุงููุญุต ูุงูุฅุดุนุงุฑุงุช

| ุงูุฃูุงู ุงููุชุจููุฉ | ููุน ุงูุชูุจูู | ุงูุฃููููุฉ | ูุชู ููุฑุณู |
|-----------------|-------------|----------|-----------|
| 7-8 ุฃูุงู | ูุฑูุจุฉ ุงูุงุณุชุญูุงู | ููุฎูุถุฉ | ุนูุฏ ุงููุญุต ุงูุฏูุฑู |
| 4-6 ุฃูุงู | ูุฑูุจุฉ ุงูุงุณุชุญูุงู | ูุชูุณุทุฉ | ุนูุฏ ุงููุญุต ุงูุฏูุฑู |
| 1-3 ุฃูุงู | ูุฑูุจุฉ ุงูุงุณุชุญูุงู | ุนุงููุฉ | ุนูุฏ ุงููุญุต ุงูุฏูุฑู |
| ุงูููู (0) | ูุณุชุญูุฉ ุงูููู | ุนุงุฌูุฉ | ููุฑุงู |
| ูุชุฃุฎุฑุฉ (-1 ุฃู ุฃูู) | ูุชุฃุฎุฑุฉ | ุนุงุฌูุฉ | ููุฑุงู |

#### ุฌ. ุงููุญุต ุงูุชููุงุฆู

**ุงูููู**: `hooks/useNotifications.ts`

```typescript
// ุชุญุฏูุซ ุฏูุฑู ูู 5 ุฏูุงุฆู
useEffect(() => {
    const interval = setInterval(() => {
        loadNotifications();
        checkPayments();
    }, 5 * 60 * 1000); // 5 ุฏูุงุฆู

    return () => clearInterval(interval);
}, [loadNotifications, checkPayments]);
```

#### ุฏ. ุขููุฉ ุนูู ูุธุงู ุงูุชูุจููุงุช

1. **ุงููุญุต ุงูุฏูุฑู**: ูู 5 ุฏูุงุฆู
2. **ุงูุงุณุชุนูุงู**: ุฌูุจ ุงูุฏูุนุงุช ุงููุฌุฏููุฉ ุงููุงุฏูุฉ (ุฎูุงู 7 ุฃูุงู)
3. **ุงูุชุตููุฉ**: ุงุณุชุจุนุงุฏ ุงูุฏูุนุงุช ุงููุฏููุนุฉ
4. **ุงูุชุญูู ูู ุงูุชูุฑุงุฑ**: ุนุฏู ุฅุฑุณุงู ุชูุจูู ููุฑุฑ ูููุณ ุงูุฏูุนุฉ
5. **ุงูุฅูุดุงุก**: ุฅูุดุงุก ุชูุจูู ุฌุฏูุฏ ูุน ุงูุชูุงุตูู
6. **ุงูุนุฑุถ**: ุนุฑุถ ุงูุชูุจูู ูู ูุงุฌูุฉ ุงููุณุชุฎุฏู

#### ูู. ูุญุชูู ุงูุชูุจูู

ูุชุถูู ูู ุชูุจูู:
- **ุงูุนููุงู**: ุญุณุจ ููุน ุงูุชูุจูู
- **ุงูุฑุณุงูุฉ**: ุชูุงุตูู ุงูุฏูุนุฉ
- **ุงููุจูุบ**: ุงููุจูุบ ุงููุณุชุญู
- **ุงูุชุงุฑูุฎ**: ุชุงุฑูุฎ ุงูุงุณุชุญูุงู
- **ุงุณู ุงูุนููู**: ุงููุดุชุฑู
- **ุงุณู ุงููุญุฏุฉ**: ุงููุญุฏุฉ ุงููุญุฌูุฒุฉ

#### ู. ุงููุตูู ุฅูู ุงูุชูุจููุงุช

##### 1. ุตูุญุฉ ุงูุชูุจููุงุช (Notifications)
- ุนุฑุถ ุฌููุน ุงูุชูุจููุงุช
- ุชุตููุฉ ุญุณุจ ุงูููุน
- ูุถุน ุนูุงูุฉ ููุฑูุก
- ุญุฐู ุงูุชูุจููุงุช

##### 2. ุงูุฅุดุนุงุฑุงุช ูู ุงููุงุฌูุฉ
- ุนุฏุงุฏ ุงูุชูุจููุงุช ุบูุฑ ุงูููุฑูุกุฉ
- ุชุญุฏูุซ ููุฑู ุนูุฏ ูุตูู ุชูุจูู ุฌุฏูุฏ

---

## ููููุฉ ุงูุงุณุชุฎุฏุงู

### ุฅูุดุงุก ุญุฌุฒ ูุน ุฎุทุฉ ุฏูุน

1. ุงูุชูู ุฅูู **ุฅุฏุงุฑุฉ ุงูุญุฌูุฒุงุช**
2. ุงุถุบุท ุนูู **ุญุฌุฒ ุฌุฏูุฏ**
3. ุงุฎุชุฑ ุงููุญุฏุฉ ูุงูุนููู
4. ุญุฏุฏ ูุจูุบ ุงูุญุฌุฒ (ุงูุนุฑุจูู)
5. ูุนูู **ุฎุทุฉ ุงูุฏูุน ุงููุฌุฏููุฉ**
6. ุงุฎุชุฑ:
   - ูุฏุฉ ุงูุฎุทุฉ (4 ุฃู 5 ุณููุงุช)
   - ุชูุฑุงุฑ ุงูุฏูุนุงุช (ุดูุฑูุ ูู ุดูุฑููุ ุฅูุฎ)
7. **ุชุงุฑูุฎ ุงููุณุท ุงูุฃูู**: ุณูุชู ุญุณุงุจู ุชููุงุฆูุงู (5 ุฃูุงู ุจุนุฏ ุชุงุฑูุฎ ุงูุญุฌุฒ)
8. ุงุญูุธ ุงูุญุฌุฒ
9. โ ุณูุชู ุฅูุดุงุก ุฌููุน ุงูุฃูุณุงุท ุชููุงุฆูุงู

### ูุฑุงูุจุฉ ุงูุชูุจููุงุช

#### ุงูุชุญุฏูุซ ุงููุฏูู
```typescript
// ูู ุฃู ูููู
const { checkPayments } = useNotifications();
await checkPayments();
```

#### ุงูุชุญุฏูุซ ุงูุชููุงุฆู
- ูุชู ุชููุงุฆูุงู ูู 5 ุฏูุงุฆู
- ุนูุฏ ูุชุญ ุตูุญุฉ ุงูุชูุจููุงุช
- ุนูุฏ ุชุญููู ุงูุชุทุจูู

---

## ุงุฎุชุจุงุฑ ุงููุธุงู

### 1. ุงุฎุชุจุงุฑ ุชุงุฑูุฎ ุงููุณุท ุงูุฃูู

1. ุฃูุดุฆ ุญุฌุฒ ุฌุฏูุฏ ุจุชุงุฑูุฎ ุงูููู
2. ูุนูู ุฎุทุฉ ุงูุฏูุน
3. ุชุญูู ูู ุญูู "ุชุงุฑูุฎ ุจุฏุก ุฃูู ุฏูุนุฉ"
4. ูุฌุจ ุฃู ูููู = ุชุงุฑูุฎ ุงูููู + 5 ุฃูุงู

### 2. ุงุฎุชุจุงุฑ ุงูุชูุจููุงุช

#### ุฃ. ุชูุจูู ุฏูุนุฉ ูุงุฏูุฉ
1. ุฃูุดุฆ ุญุฌุฒ ุจุชุงุฑูุฎ ููุฐ 3 ุฃูุงู (backdate)
2. ูุนูู ุฎุทุฉ ุงูุฏูุน ูุน ุชุงุฑูุฎ ุจุฏุก ููุฐ ููููู
3. ุงูุชุธุฑ ุฃู ูู ุจุชุญุฏูุซ ุงูุชูุจููุงุช ูุฏููุงู
4. ูุฌุจ ุฃู ุชุธูุฑ ุชูุจููุงุช ููุฃูุณุงุท ุงููุงุฏูุฉ

#### ุจ. ุชูุจูู ุฏูุนุฉ ุงูููู
1. ุฃูุดุฆ ุญุฌุฒ ุจุชุงุฑูุฎ ููุฐ 5 ุฃูุงู
2. ูุนูู ุฎุทุฉ ุงูุฏูุน ูุน ุชุงุฑูุฎ ุจุฏุก = ุงูููู
3. ูู ุจุชุญุฏูุซ ุงูุชูุจููุงุช
4. ูุฌุจ ุฃู ูุธูุฑ ุชูุจูู "ูุณุชุญูุฉ ุงูููู"

#### ุฌ. ุชูุจูู ุฏูุนุฉ ูุชุฃุฎุฑุฉ
1. ุฃูุดุฆ ุญุฌุฒ ุจุชุงุฑูุฎ ููุฐ 10 ุฃูุงู
2. ูุนูู ุฎุทุฉ ุงูุฏูุน ูุน ุชุงุฑูุฎ ุจุฏุก ููุฐ 3 ุฃูุงู
3. ูู ุจุชุญุฏูุซ ุงูุชูุจููุงุช
4. ูุฌุจ ุฃู ูุธูุฑ ุชูุจูู "ูุชุฃุฎุฑุฉ"

---

## ูููุงุช ุงูุชูุซูู ุฐุงุช ุงูุตูุฉ

- `docs/AUDIT_REPORT.md` - ุชูุฑูุฑ ุงููุฑุงุฌุนุฉ ุงูุดุงูู
- `docs/TROUBLESHOOTING-scheduled-payments.md` - ุญู ูุดุงูู ุงูุฏูุนุงุช ุงููุฌุฏููุฉ
- `supabase-migrations/add-payment-schedule-system.sql` - ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช

---

## ุงููููุงุช ุงููุนุฏููุฉ

- โ `components/pages/sales/Bookings.tsx` - ุฅุถุงูุฉ ุญุณุงุจ ุชุงุฑูุฎ ุงููุณุท ุงูุฃูู
- โ `hooks/useNotifications.ts` - ููุฌูุฏ ููุนูู
- โ `utils/notificationService.ts` - ููุฌูุฏ ููุนูู

---

## ุงูุฎูุงุตุฉ

โ **ุชุงุฑูุฎ ุงููุณุท ุงูุฃูู**: ูุจุฏุฃ ุจุนุฏ 5 ุฃูุงู ูู ุชุงุฑูุฎ ุงูุญุฌุฒ ุชููุงุฆูุงู  
โ **ูุธุงู ุงูุชูุจููุงุช**: ููุฌูุฏ ููุนูู ุจุดูู ูุงูู  
โ **ุงููุญุต ุงูุชููุงุฆู**: ูู 5 ุฏูุงุฆู  
โ **ุฃููุงุน ุงูุชูุจููุงุช**: ูุฑูุจุฉุ ุงููููุ ูุชุฃุฎุฑุฉ  
โ **ุงููุงุฌูุฉ**: ุณููุฉ ุงูุงุณุชุฎุฏุงู ูุน ููุงุญุธุงุช ุชูุถูุญูุฉ
