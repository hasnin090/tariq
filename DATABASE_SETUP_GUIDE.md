# ุฏููู ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุจูุงูุงุช Supabase
## ุชุงุฑูุฎ ุงูุฅูุดุงุก: 23 ููููุจุฑ 2025

---

## ๐ ููุฎุต ุงูุฌุฏุงูู

ุชู ุฅูุดุงุก **9 ูููุงุช SQL** ูุฅุนุฏุงุฏ ูุงุนุฏุฉ ุจูุงูุงุช ูุงููุฉ ููุธุงู ุฅุฏุงุฑุฉ ุงูุนูุงุฑุงุช:

### โ ุงูุฌุฏุงูู ุงููููุดุฃุฉ:

1. **users** - ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู ูุงูุตูุงุญูุงุช
2. **projects** - ุงููุดุงุฑูุน ุงูุนูุงุฑูุฉ
3. **accounts** - ุงูุญุณุงุจุงุช ุงููุงููุฉ (ููุฏูุ ุจููู)
4. **transactions** - ุงููุนุงููุงุช ุงููุงููุฉ
5. **units** - ุงููุญุฏุงุช ุงูุนูุงุฑูุฉ
6. **customers** - ุจูุงูุงุช ุงูุนููุงุก
7. **bookings** - ุงูุญุฌูุฒุงุช ูุงููุจูุนุงุช
8. **payments** - ุณุฌู ุงูุฏูุนุงุช
9. **expense_categories** - ุชุตูููุงุช ุงููุตุฑููุงุช
10. **vendors** - ุงูููุฑุฏูู ูุงูููุงูููู
11. **expenses** - ุงููุตุฑููุงุช
12. **budgets** - ุงูููุฒุงููุงุช

---

## ๐ ุทุฑููุฉ ุงูุชูููุฐ

### ุงูุฎูุงุฑ 1: ุงุณุชุฎุฏุงู Supabase CLI (ููุตู ุจู)

```powershell
# ุชุฃูุฏ ูู ุชุณุฌูู ุงูุฏุฎูู
npx supabase login --token YOUR_ACCESS_TOKEN

# ุฑุจุท ุงููุดุฑูุน
npx supabase link --project-ref dlxtduzxlwogpwxjeqxm

# ุฑูุน ุฌููุน ุงูู migrations
npx supabase db push
```

### ุงูุฎูุงุฑ 2: ูู ุฎูุงู VS Code ูุจุงุดุฑุฉ

ุฅุฐุง ููุช ูุฏ ูุตูุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุน VS Code:

1. ุงูุชุญ ูู ููู SQL ูู ูุฌูุฏ `supabase/migrations/`
2. ูููุฐ ุงููููุงุช **ุจุงูุชุฑุชูุจ** ุงูุชุงูู:

```
20241123000001_users.sql        โ ุฅุถุงูุฉ ุฃุนูุฏุฉ ูุฌุฏูู users
20241123000002_projects.sql     โ ุฌุฏูู ุงููุดุงุฑูุน
20241123000003_accounts.sql     โ ุงูุญุณุงุจุงุช ุงููุงููุฉ
20241123000004_transactions.sql โ ุงููุนุงููุงุช ุงููุงููุฉ
20241123000005_units.sql        โ ุงููุญุฏุงุช ุงูุนูุงุฑูุฉ
20241123000006_customers.sql    โ ุงูุนููุงุก
20241123000007_bookings.sql     โ ุงูุญุฌูุฒุงุช
20241123000008_payments.sql     โ ุงูุฏูุนุงุช
20241123000009_expenses.sql     โ ุงููุตุฑููุงุช ูุงูููุฒุงููุงุช
```

### ุงูุฎูุงุฑ 3: ูู ููุญุฉ ุชุญูู Supabase

1. ุงุฐูุจ ุฅูู: https://supabase.com/dashboard/project/dlxtduzxlwogpwxjeqxm/editor
2. ุงูุชูู ุฅูู ุชุจููุจ **SQL Editor**
3. ุงูุณุฎ ูุญุชูู ูู ููู ููููุฐู ุจุงูุชุฑุชูุจ ุฃุนูุงู

---

## ๐ ุงูุชุญูู ูู ุงูุชูููุฐ

ุจุนุฏ ุชูููุฐ ุฌููุน ุงููููุงุชุ ูููุฐ ูุฐุง ุงูุงุณุชุนูุงู ููุชุฃูุฏ:

```sql
-- ุงูุชุญูู ูู ุฌููุน ุงูุฌุฏุงูู
SELECT 
    table_name,
    CASE 
        WHEN table_name IN ('users', 'projects', 'accounts', 'transactions', 
                            'units', 'customers', 'bookings', 'payments',
                            'expenses', 'expense_categories', 'vendors', 'budgets')
        THEN 'โ ููุฌูุฏ'
        ELSE 'ุ ุบูุฑ ูุชููุน'
    END as status
FROM information_schema.tables
WHERE table_schema = 'public'
ORDER BY table_name;
```

ูุฌุจ ุฃู ุชุธูุฑ **12 ุฌุฏูู** ุนูู ุงูุฃูู.

---

## ๐ ุงูุนูุงูุงุช ุจูู ุงูุฌุฏุงูู

```
users โโโ
        โ
projects โโโฌโโ units โโโฌโโ bookings โโโฌโโ payments
           โ           โ               โ
           โ           โโโ customers โโโ
           โ
           โโโ expenses โโโฌโโ expense_categories
           โ              โโโ vendors
           โ              โโโ accounts
           โ
           โโโ budgets โโโโ expense_categories
           โ
           โโโ transactions โโโโ accounts
```

---

## ๐ ุงูุตูุงุญูุงุช (RLS Policies)

ุฌููุน ุงูุฌุฏุงูู ูุฏููุง **Row Level Security (RLS)** ูููุนูู ูุน ุงูุณูุงุณุงุช ุงูุชุงููุฉ:

- โ **SELECT**: ูู ุงููุณุชุฎุฏููู ุงููุตุงุฏููู ูููููู ุงููุฑุงุกุฉ
- โ **INSERT**: ูู ุงููุณุชุฎุฏููู ุงููุตุงุฏููู ูููููู ุงูุฅุถุงูุฉ
- โ **UPDATE**: ูู ุงููุณุชุฎุฏููู ุงููุตุงุฏููู ูููููู ุงูุชุนุฏูู
- โ **DELETE**: ูู ุงููุณุชุฎุฏููู ุงููุตุงุฏููู ูููููู ุงูุญุฐู

> **ููุงุญุธุฉ**: ูุฐู ุตูุงุญูุงุช ุฃุณุงุณูุฉ. ููููู ุชุฎุตูุตูุง ูุงุญูุงู ุญุณุจ ุงุญุชูุงุฌุงุช ุงูุชุทุจูู.

---

## โก Triggers ุงูุชููุงุฆูุฉ

ุชู ุฅูุดุงุก triggers ููุชุญุฏูุซุงุช ุงูุชุงููุฉ:

1. **updated_at**: ุชุญุฏูุซ ุชููุงุฆู ูุชุงุฑูุฎ ุงูุชุนุฏูู ูู ุฌููุน ุงูุฌุฏุงูู
2. **update_account_balance_on_transaction**: ุชุญุฏูุซ ุฃุฑุตุฏุฉ ุงูุญุณุงุจุงุช ุชููุงุฆูุงู
3. **update_unit_status_on_booking**: ุชุบููุฑ ุญุงูุฉ ุงููุญุฏุฉ ุนูุฏ ุงูุญุฌุฒ
4. **update_booking_remaining_amount**: ุชุญุฏูุซ ุงููุจูุบ ุงููุชุจูู ุนูุฏ ุฅุถุงูุฉ ุฏูุนุฉ

---

## ๐ฏ ุงูุจูุงูุงุช ุงูุงูุชุฑุงุถูุฉ

ุณูุชู ุฅุถุงูุฉ ุงูุจูุงูุงุช ุงูุชุงููุฉ ุชููุงุฆูุงู:

### Users (ูุณุชุฎุฏููู)
- **admin** / admin123
- **sales** / sales123
- **accounting** / accounting123

### Projects (ูุดุงุฑูุน)
- ูุดุฑูุน ุงููุฎูู (ุงูุฑูุงุถ)
- ูุดุฑูุน ุงููุงุญุฉ (ุฌุฏุฉ)

### Accounts (ุญุณุงุจุงุช)
- ุงูุตูุฏูู (ููุฏู)
- ุงูุจูู ุงูุฃููู

### Expense Categories (ุชุตูููุงุช)
- ุฑูุงุชุจ ูุฃุฌูุฑ
- ุตูุงูุฉ
- ููุงุฏ ุจูุงุก
- ููุงููุงุช
- ูุตุงุฑูู ุฅุฏุงุฑูุฉ

---

## ๐ ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ

### ูุดููุฉ: "column already exists"
**ุงูุญู**: ูุฐุง ุทุจูุนู - ุงููููุงุช ุชุณุชุฎุฏู `IF NOT EXISTS` ูุชุฌูุจ ุงูุชูุฑุงุฑ.

### ูุดููุฉ: "foreign key constraint violation"
**ุงูุญู**: ุชุฃูุฏ ูู ุชูููุฐ ุงููููุงุช ุจุงูุชุฑุชูุจ ุงูุตุญูุญ (users โ projects โ accounts โ ุฅูุฎ).

### ูุดููุฉ: "permission denied"
**ุงูุญู**: ุชุฃูุฏ ูู ุฃูู ูุณุฌู ุฏุฎูู ูู service_role ุฃู ุฃู ูุฏูู ุตูุงุญูุงุช admin.

### ูุดููุฉ: "relation does not exist"
**ุงูุญู**: ุชุญูู ูู ุฃู ุฌุฏูู projects ููุฌูุฏ ูุจู ุชูููุฐ units/bookings/payments.

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉ:

1. ุชุญูู ูู ุฃุฎุทุงุก SQL ูู Output
2. ุงุณุชุฎุฏู `check-tables.sql` ููุชุญูู ูู ุงูุฌุฏุงูู ุงูููุฌูุฏุฉ
3. ุฑุงุฌุน ุชุฑุชูุจ ุชูููุฐ ุงููููุงุช

---

## โจ ุงูุฎุทูุงุช ุงูุชุงููุฉ

ุจุนุฏ ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช:

1. โ ุชุญุฏูุซ ููู `.env` ุจูุนูููุงุช ุงูุงุชุตุงู
2. โ ุงุฎุชุจุงุฑ ุชุณุฌูู ุงูุฏุฎูู ุจุงููุณุชุฎุฏููู ุงูุงูุชุฑุงุถููู
3. โ ุฅุถุงูุฉ ูุดุฑูุน ุชุฌุฑูุจู
4. โ ุฅุถุงูุฉ ูุญุฏุฉ ุนูุงุฑูุฉ ุชุฌุฑูุจูุฉ
5. โ ุงุฎุชุจุงุฑ ุนูููุฉ ุญุฌุฒ ูุงููุฉ

---

**ุชู ุจูุฌุงุญ! ๐**
